/* ******************** */
/* DEFINES you can tune */
// BOOL :
// 0 => desactivated
// 1 => activated
#define INVERSE_X_AXE  0
#define INVERSE_Y_AXE  0
#define WIREFRAME      0
#define RENDER_SHADOWS 1
#define PHONG_LIGNTING 1
#define REFLEXION      1
#define BALL_PATTERN   1
#define GRASS_PATTERN  1
#define UPDATE_PHYSICS 1
#define SHOW_MEMORY    1

// FLOAT :
#define MOUSE_SENSITIVITY   2.0f
#define MAX_SPEED          30.0f
#define TIME_TO_MAX_SPEED   1.5f
#define BALL_MASS           0.5f
#define BALL_SIZE           0.4f
#define SEA_LEVEL         -10.0f
#define MAX_RESOLUTION   1600.0f
// VEC3 :
#define LIGHT_DIR        vec3(1.5, 1.2, 0.5)
#define LIGHT_COLOR      vec3(1.0, 1.0, 0.97)
#define BALL_INITIAL_POS vec3(0.0, 1.0, 0.0)
/* ******************** */

/* ************* */
/* other DEFINES */
// probably better to not touch
#define MEMORY_CHANNEL iChannel0
#define epsilon 0.00001
#define PI 3.141592653589
#define G 9.81
#define WORLD_UP vec3(0.,1.,0.)
#define SKY_COLOR   vec3(0.380,0.929,1.000)
#define SEA_COLOR   vec3(0.388,0.665,0.851)
#define USE_BOUNDINGBALL 1
/* ************* */

/* MEMORY ADRESSES */
const ivec2 memorySeparator        = ivec2(0,9); // 
const ivec2 gameStateAdress        = ivec2(0,0);                          // r : game initialised ; g :  ; b : SPACE was pressed ; a : time spent with SPACE press
const ivec2 charPosAdress          = gameStateAdress       + memorySeparator;
const ivec2 charDirectionAdress    = charPosAdress         + memorySeparator;
const ivec2 charSpeedAdress        = charDirectionAdress   + memorySeparator;
const ivec2 charAccelerationAdress = charSpeedAdress       + memorySeparator;
const ivec2 camAnglesAdress        = charAccelerationAdress+ memorySeparator;
const ivec2 mouseLastPosAdress     = camAnglesAdress       + memorySeparator;
const ivec2 camPosAdress           = mouseLastPosAdress    + memorySeparator;
const ivec2 sphereRotationAdress   = camPosAdress          + memorySeparator; // x : x angle ; y : y angle ; z : z angle
const ivec2 dividingAdress         = sphereRotationAdress  + memorySeparator;
const ivec2 savedPosAdress         = dividingAdress        + memorySeparator;
const ivec2 tilesSeted             = savedPosAdress        + memorySeparator;
const ivec2 tilesAdress            = tilesSeted            + memorySeparator;
//const ivec2 start
/* *************** */


const float renderDistance = 200.;


/* ********************* */
/* LEVEL BULDING DEFINES */
#define BUMP ivec2(0,32) 
#define PLANE ivec2(32,34) 
#define PIT ivec2(34,164) 
#define RAMP ivec2(164,196)
#define ELEVATION ivec2(196, 228)
#define WALL ivec2(228, 240)
#define FINISH ivec2(240, 274)

#define BALL_COLOR vec3(1.0)
#define GRASS_COLOR vec3(0., 0.7765, 0.498)
#define WALL_COLOR  vec3(0.9451, 0.5255, 0.549)
/* ********************* */

const float radiusWall = 6.2;
 
 const mat3 rotY_0 = mat3(
    1.0,  0.0,  0.0,
    0.0,  1.0,  0.0,
    0.0,  0.0,  1.0
);

const mat3 rotY_90 = mat3(
    0.0,  0.0,  1.0,
    0.0,  1.0,  0.0,
   -1.0,  0.0,  0.0
);

const mat3 rotY_180 = mat3(
   -1.0,  0.0,  0.0,
    0.0,  1.0,  0.0,
    0.0,  0.0, -1.0
);

const mat3 rotY_270 = mat3(
    0.0,  0.0, -1.0,
    0.0,  1.0,  0.0,
    1.0,  0.0,  0.0
);

const mat3 rotY_45 = mat3(
    0.70710678,  0.0,  0.70710678,
    0.0,         1.0,  0.0,
   -0.70710678,  0.0,  0.70710678
);

const mat3 rotY_n45 = mat3(
    0.70710678,  0.0, -0.70710678,
    0.0,         1.0,  0.0,
    0.70710678,  0.0,  0.70710678
);
 
struct Tile
{
    vec3 position;
    ivec2 type;
    float boundingSphereRadius;
    vec3 color;
    mat3 rotationMatrix;
};

const Tile tiles[49] = Tile[]
(
    Tile(vec3(  0.0,   0.0,   0.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3(  0.0,  -1.0,  -5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3(  0.0,  -1.0,   5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3(  4.5,  -1.0,   0.0), WALL      , radiusWall, WALL_COLOR, rotY_90),
    
    Tile(vec3( -10.,   0.0,   0.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -10.,  -1.0,  -5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -10.,  -1.0,   5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    
    Tile(vec3( -20.,   0.0,   0.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,  -1.0,  -5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -20.,  -1.0,   5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    
    Tile(vec3( -30.,   0.0,   0.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -30.,  -1.0,  -5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -30.,  -1.0,   5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    
    Tile(vec3( -40.,   0.0,   0.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -40.,  -1.0,   5.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -44.5,  -1.0,   0.0), WALL      , radiusWall, WALL_COLOR, rotY_90),
    Tile(vec3( -41.,  -1.0,   1.5), WALL      , radiusWall, WALL_COLOR, rotY_n45),
    
    Tile(vec3( -40.,   0.0, -10.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -44.5,  -1.0, -10.0), WALL      , radiusWall, WALL_COLOR, rotY_90),
    
    Tile(vec3( -40.,   0.0, -20.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -40.,  -1.0, -25.0), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -44.5,  -1.0, -20.0), WALL      , radiusWall, WALL_COLOR, rotY_90),
    Tile(vec3( -41.,  -1.0, -21.5), WALL      , radiusWall, WALL_COLOR, rotY_45),
    
    Tile(vec3( -30.,   0.0, -20.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -30.,  -1.0, -25.), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -30.,  -1.0, -15.), WALL      , radiusWall, WALL_COLOR, rotY_0),
    
    
    Tile(vec3( -20.,   0.0, -20.0), RAMP     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,  -1.0, -25.), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -20.,  -1.0, -15.), WALL      , radiusWall, WALL_COLOR, rotY_0),
    Tile(vec3( -15.5,  -1.0, -20.), WALL      , radiusWall, WALL_COLOR, rotY_90),

    Tile(vec3(  10.,   1.0, -20.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3(  20.,   1.0, -20.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( 25.,  0.0, -20.0),   WALL      , radiusWall, WALL_COLOR, rotY_90),
    
    Tile(vec3(  20.,   1.0, -30.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3(  20.,   1.0, -40.0), ELEVATION , 7.1, GRASS_COLOR, rotY_90),
    Tile(vec3(  20.,   3.5, -50.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3(  20.,   3.5, -60.0), PIT       , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3(  10.,   1.0, -60.0), ELEVATION , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3(  00.,   1.0, -60.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -10.,   1.0, -60.0), BUMP      , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,   1.0, -60.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,   1.0, -50.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,   1.0, -40.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,   1.0, -30.0), RAMP      , 7.1, GRASS_COLOR, rotY_270),
    Tile(vec3( -20.,   1.0,  10.0), PLANE     , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,   1.0,  20.0), FINISH    , 7.1, GRASS_COLOR, rotY_0),
    Tile(vec3( -20.,  -0.2,  25.0), WALL      , 7.1, WALL_COLOR, rotY_0),
    Tile(vec3( -15.,  -0.2,  20.5), WALL      , 7.1, WALL_COLOR, rotY_90),
    Tile(vec3( -25.,  -0.2,  20.5), WALL      , 7.1, WALL_COLOR, rotY_90)
        
);

const vec3 verticesTiles[223] = vec3[](
vec3( -5.000000, 0.000000, 5.000000 ), // 0 small bump start & plane start
vec3( 5.000000, 0.000000, 5.000000 ),
vec3( -5.000000, 0.000000, -5.000000 ),
vec3( 5.000000, 0.000000, -5.000000 ), // 3 plane end
vec3( 0.000000, 1.000000, 5.000000 ),
vec3( 0.000000, 1.000000, -5.000000 ),
vec3( -2.500000, 0.338010, -5.000000 ),
vec3( -2.500000, 0.338010, 5.000000 ),
vec3( 2.500000, 0.338010, 5.000000 ),
vec3( 2.500000, 0.338010, -5.000000 ),
vec3( 1.250000, 0.777825, -5.000000 ),
vec3( 1.250000, 0.777825, 5.000000 ),
vec3( -1.250000, 0.777825, 5.000000 ),
vec3( -1.250000, 0.777825, -5.000000 ),
vec3( -3.750000, 0.020618, -5.000000 ),
vec3( -3.750000, 0.020618, 5.000000 ),
vec3( 3.750000, 0.020618, 5.000000 ),
vec3( 3.750000, 0.020618, -5.000000 ),
vec3( 3.125000, 0.142757, -5.000000 ),
vec3( 3.125000, 0.142757, 5.000000 ),
vec3( 4.375000, 0.000000, 5.000000 ),
vec3( 4.375000, 0.000000, -5.000000 ),
vec3( 1.875000, 0.563869, 5.000000 ),
vec3( 1.875000, 0.563869, -5.000000 ),
vec3( 0.625000, 0.937372, -5.000000 ),
vec3( 0.625000, 0.937372, 5.000000 ),
vec3( -0.625000, 0.937372, 5.000000 ),
vec3( -0.625000, 0.937372, -5.000000 ),
vec3( -1.875000, 0.563869, -5.000000 ),
vec3( -1.875000, 0.563869, 5.000000 ),
vec3( -3.125000, 0.142757, 5.000000 ),
vec3( -3.125000, 0.142757, -5.000000 ),
vec3( -4.375000, 0.000000, -5.000000 ),
vec3( -4.375000, 0.000000, 5.000000 ), // 33 small bump end
vec3( -5.000000, 0.000000, 5.000000 ), // 34 pit start
vec3( 5.000000, 0.000000, 5.000000 ),
vec3( -5.000000, 0.000000, -5.000000 ),
vec3( 5.000000, 0.000000, -5.000000 ),
vec3( -5.000000, 0.000000, 0.000000 ),
vec3( 0.000000, 0.000000, 5.000000 ),
vec3( 5.000000, 0.000000, 0.000000 ),
vec3( 0.000000, 0.000000, -5.000000 ),
vec3( 0.000000, -1.500000, 0.000000 ),
vec3( -5.000000, 0.000000, 2.500000 ),
vec3( 2.500000, 0.000000, 5.000000 ),
vec3( 5.000000, 0.000000, -2.500000 ),
vec3( -2.500000, 0.000000, -5.000000 ),
vec3( -5.000000, 0.000000, -2.500000 ),
vec3( -2.500000, 0.000000, 5.000000 ),
vec3( 5.000000, 0.000000, 2.500000 ),
vec3( 2.500000, 0.000000, -5.000000 ),
vec3( 0.000000, -0.507015, -2.500000 ),
vec3( 0.000000, -0.507015, 2.500000 ),
vec3( -2.500000, -0.507015, 0.000000 ),
vec3( 2.500000, -0.507015, 0.000000 ),
vec3( 2.500000, -0.077466, 2.500000 ),
vec3( -2.500000, -0.077466, 2.500000 ),
vec3( -2.500000, -0.077466, -2.500000 ),
vec3( 2.500000, -0.077466, -2.500000 ),
vec3( -5.000000, 0.000000, 3.750000 ),
vec3( 3.750000, 0.000000, 5.000000 ),
vec3( 5.000000, 0.000000, -3.750000 ),
vec3( -3.750000, 0.000000, -5.000000 ),
vec3( -5.000000, 0.000000, -1.250000 ),
vec3( -1.250000, 0.000000, 5.000000 ),
vec3( 5.000000, 0.000000, 1.250000 ),
vec3( 1.250000, 0.000000, -5.000000 ),
vec3( 0.000000, -0.030927, -3.750000 ),
vec3( 0.000000, -1.166738, 1.250000 ),
vec3( -3.750000, -0.030927, 0.000000 ),
vec3( 1.250000, -1.166738, 0.000000 ),
vec3( -5.000000, 0.000000, 1.250000 ),
vec3( 1.250000, 0.000000, 5.000000 ),
vec3( 5.000000, 0.000000, -1.250000 ),
vec3( -1.250000, 0.000000, -5.000000 ),
vec3( -5.000000, 0.000000, -3.750000 ),
vec3( -3.750000, 0.000000, 5.000000 ),
vec3( 5.000000, 0.000000, 3.750000 ),
vec3( 3.750000, 0.000000, -5.000000 ),
vec3( 0.000000, -1.166738, -1.250000 ),
vec3( 0.000000, -0.030927, 3.750000 ),
vec3( -1.250000, -1.166738, 0.000000 ),
vec3( 3.750000, -0.030927, 0.000000 ),
vec3( 2.500000, -0.359117, 1.250000 ),
vec3( 2.500000, 0.000000, 3.750000 ),
vec3( 1.250000, -0.359117, 2.500000 ),
vec3( 3.750000, 0.000000, 2.500000 ),
vec3( -2.500000, -0.359117, 1.250000 ),
vec3( -2.500000, 0.000000, 3.750000 ),
vec3( -3.750000, 0.000000, 2.500000 ),
vec3( -1.250000, -0.359117, 2.500000 ),
vec3( -2.500000, 0.000000, -3.750000 ),
vec3( -2.500000, -0.359117, -1.250000 ),
vec3( -3.750000, 0.000000, -2.500000 ),
vec3( -1.250000, -0.359117, -2.500000 ),
vec3( 2.500000, 0.000000, -3.750000 ),
vec3( 2.500000, -0.359117, -1.250000 ),
vec3( 1.250000, -0.359117, -2.500000 ),
vec3( 3.750000, 0.000000, -2.500000 ),
vec3( 3.750000, -0.005658, -1.250000 ),
vec3( 1.250000, -0.903905, -1.250000 ),
vec3( 1.250000, -0.005658, -3.750000 ),
vec3( -1.250000, -0.903905, -1.250000 ),
vec3( -3.750000, -0.005658, -1.250000 ),
vec3( -3.750000, 0.000000, -3.750000 ),
vec3( -1.250000, -0.005658, 3.750000 ),
vec3( -3.750000, 0.000000, 3.750000 ),
vec3( -3.750000, -0.005658, 1.250000 ),
vec3( 3.750000, 0.000000, 3.750000 ),
vec3( 1.250000, -0.005658, 3.750000 ),
vec3( 1.250000, -0.903905, 1.250000 ),
vec3( 3.750000, -0.005658, 1.250000 ),
vec3( -1.250000, -0.903905, 1.250000 ),
vec3( -1.250000, -0.005658, -3.750000 ),
vec3( 3.750000, 0.000000, -3.750000 ),
vec3( -1.000002, -1.248415, 0.999999 ),
vec3( 0.999998, -1.248415, 0.999999 ),
vec3( -1.000002, -1.248415, -1.000001 ),
vec3( 0.999998, -1.248415, -1.000001), // 118 pit end
vec3( -5.000000, 0.000000, 5.000000 ), // 119 ramp start
vec3( 5.000000, 2.035652, 5.000000 ),
vec3( -5.000000, 0.000000, -5.000000 ),
vec3( 5.000000, 2.035652, -5.000000 ),
vec3( 0.000000, 0.337005, 5.000000 ),
vec3( 0.000000, 0.337005, -5.000000 ),
vec3( -2.500000, 0.024775, -5.000000 ),
vec3( -2.500000, 0.024775, 5.000000 ),
vec3( 2.500000, 1.007298, 5.000000 ),
vec3( 2.500000, 1.007298, -5.000000 ),
vec3( 3.750000, 1.476717, 5.000000 ),
vec3( 3.750000, 1.476717, -5.000000 ),
vec3( 1.250000, 0.627394, -5.000000 ),
vec3( 1.250000, 0.627394, 5.000000 ),
vec3( -1.250000, 0.136132, 5.000000 ),
vec3( -1.250000, 0.136132, -5.000000 ),
vec3( -3.750000, 0.000000, -5.000000 ),
vec3( -3.750000, 0.000000, 5.000000 ),
vec3( 4.375000, 1.744995, 5.000000 ),
vec3( 4.375000, 1.744995, -5.000000 ),
vec3( 3.125000, 1.230818, -5.000000 ),
vec3( 3.125000, 1.230818, 5.000000 ),
vec3( 1.875000, 0.806156, 5.000000 ),
vec3( 1.875000, 0.806156, -5.000000 ),
vec3( 0.625000, 0.471010, -5.000000 ),
vec3( 0.625000, 0.471010, 5.000000 ),
vec3( -0.625000, 0.225379, 5.000000 ),
vec3( -0.625000, 0.225379, -5.000000 ),
vec3( -1.875000, 0.069264, -5.000000 ),
vec3( -1.875000, 0.069264, 5.000000 ),
vec3( -3.125000, 0.002665, 5.000000 ),
vec3( -3.125000, 0.002665, -5.000000 ),
vec3( -4.375000, 0.000000, -5.000000 ),
vec3( -4.375000, 0.000000, 5.000000),   // 152 ramp end
vec3( -5.000000, 0.000000, 5.000000 ),  // 153 elevation start
vec3( 5.000000, 2.500000, 5.000000 ),
vec3( -5.000000, 0.000000, -5.000000 ),
vec3( 5.000000, 2.500000, -5.000000 ),
vec3( 0.000591, 0.905092, 5.000000 ),
vec3( 0.000591, 0.905092, -5.000000 ),
vec3( -2.499705, 0.084617, -5.000000 ),
vec3( -2.499705, 0.084617, 5.000000 ),
vec3( 2.500295, 1.970910, 5.000000 ),
vec3( 2.500295, 1.970910, -5.000000 ),
vec3( 3.750148, 2.351432, 5.000000 ),
vec3( 3.750148, 2.351432, -5.000000 ),
vec3( 1.250443, 1.456206, -5.000000 ),
vec3( 1.250443, 1.456206, 5.000000 ),
vec3( -1.249557, 0.415238, 5.000000 ),
vec3( -1.249557, 0.415238, -5.000000 ),
vec3( -3.749852, 0.000000, -5.000000 ),
vec3( -3.749852, 0.000000, 5.000000 ),
vec3( -3.124778, 0.009595, 5.000000 ),
vec3( -3.124778, 0.009595, -5.000000 ),
vec3( -4.374926, 0.000000, -5.000000 ),
vec3( -4.374926, 0.000000, 5.000000 ),
vec3( -1.874631, 0.223909, -5.000000 ),
vec3( -1.874631, 0.223909, 5.000000 ),
vec3( -0.624483, 0.646376, 5.000000 ),
vec3( -0.624483, 0.646376, -5.000000 ),
vec3( 0.625517, 1.179089, -5.000000 ),
vec3( 0.625517, 1.179089, 5.000000 ),
vec3( 1.875369, 1.724221, 5.000000 ),
vec3( 1.875369, 1.724221, -5.000000 ),
vec3( 3.125222, 2.184055, -5.000000 ),
vec3( 3.125222, 2.184055, 5.000000 ),
vec3( 4.375074, 2.460821, 5.000000 ),
vec3( 4.375074, 2.460821, -5.000000),   // 186 elevation end
vec3( -5.000000, -2.500000, 0.500000 ), // 187 wall start
vec3( -5.000000, 2.500000, 0.500000 ),
vec3( -5.000000, -2.500000, -0.500000 ),
vec3( -5.000000, 2.500000, -0.500000 ),
vec3( 5.000000, -2.500000, 0.500000 ),
vec3( 5.000000, 2.500000, 0.500000 ),
vec3( 5.000000, -2.500000, -0.500000 ),
vec3( 5.000000, 2.500000, -0.500000),  // 195 wall end
vec3( -1.000000, 0.000000, 1.000000 )*5.,
vec3( 0.000000, 0.000000, -0.300000 )*5.,
vec3( 1.000000, 0.000000, 1.000000 )*5.,
vec3( -1.000000, 0.000000, -1.000000 )*5.,
vec3( 0.212132, 0.000000, -0.212132 )*5.,
vec3( 1.000000, 0.000000, -1.000000 )*5.,
vec3( 0.300000, 0.000000, 0.000000 )*5.,
vec3( 0.212132, 0.000000, 0.212132 )*5.,
vec3( 0.000000, 0.000000, 0.300000 )*5.,
vec3( -0.212132, 0.000000, 0.212132 )*5.,
vec3( -0.300000, 0.000000, 0.000000 )*5.,
vec3( -0.212132, 0.000000, -0.212132 )*5.,
vec3( 0.000000, -1.000000, -0.300000 )*5.,
vec3( 0.000000, 0.000000, -0.300000 )*5.,
vec3( 0.212132, -1.000000, -0.212132 )*5.,
vec3( 0.212132, 0.000000, -0.212132 )*5.,
vec3( 0.300000, -1.000000, 0.000000 )*5.,
vec3( 0.300000, 0.000000, 0.000000 )*5.,
vec3( 0.212132, -1.000000, 0.212132 )*5.,
vec3( 0.212132, 0.000000, 0.212132 )*5.,
vec3( 0.000000, -1.000000, 0.300000 )*5.,
vec3( 0.000000, 0.000000, 0.300000 )*5.,
vec3( -0.212132, -1.000000, 0.212132 )*5.,
vec3( -0.212132, 0.000000, 0.212132 )*5.,
vec3( -0.300000, -1.000000, 0.000000 )*5.,
vec3( -0.300000, 0.000000, 0.000000 )*5.,
vec3( -0.212132, -1.000000, -0.212132 )*5.,
vec3( -0.212132, 0.000000, -0.212132)*5. //223
);

const ivec3 trianglesTile[274] = ivec3[](
ivec3( 2 - 1, 22 - 1, 21 - 1), // small bump start 0
ivec3( 5 - 1, 28 - 1, 27 - 1),
ivec3( 8 - 1, 32 - 1, 31 - 1),
ivec3( 9 - 1, 24 - 1, 23 - 1),
ivec3( 12 - 1, 25 - 1, 26 - 1),
ivec3( 13 - 1, 29 - 1, 30 - 1),
ivec3( 16 - 1, 33 - 1, 34 - 1),
ivec3( 17 - 1, 19 - 1, 20 - 1),
ivec3( 20 - 1, 10 - 1, 9 - 1),
ivec3( 21 - 1, 18 - 1, 17 - 1),
ivec3( 23 - 1, 11 - 1, 12 - 1),
ivec3( 26 - 1, 6 - 1, 5 - 1),
ivec3( 27 - 1, 14 - 1, 13 - 1),
ivec3( 30 - 1, 7 - 1, 8 - 1),
ivec3( 31 - 1, 15 - 1, 16 - 1),
ivec3( 34 - 1, 3 - 1, 1 - 1),
ivec3( 2 - 1, 4 - 1, 22 - 1),
ivec3( 5 - 1, 6 - 1, 28 - 1),
ivec3( 8 - 1, 7 - 1, 32 - 1),
ivec3( 9 - 1, 10 - 1, 24 - 1),
ivec3( 12 - 1, 11 - 1, 25 - 1),
ivec3( 13 - 1, 14 - 1, 29 - 1),
ivec3( 16 - 1, 15 - 1, 33 - 1),
ivec3( 17 - 1, 18 - 1, 19 - 1),
ivec3( 20 - 1, 19 - 1, 10 - 1),
ivec3( 21 - 1, 22 - 1, 18 - 1),
ivec3( 23 - 1, 24 - 1, 11 - 1),
ivec3( 26 - 1, 25 - 1, 6 - 1),
ivec3( 27 - 1, 28 - 1, 14 - 1),
ivec3( 30 - 1, 29 - 1, 7 - 1),
ivec3( 31 - 1, 32 - 1, 15 - 1),
ivec3( 34 - 1, 33 - 1, 3 - 1),  // small bump end 31
ivec3( 0, 1, 2),                // plane start 32
ivec3(1,2,3),                   // plane end 33
ivec3(61,78,114),               // pit start 34
ivec3(113,41,74),
ivec3(68,81,112),
ivec3(111,40,82),
ivec3(110,54,70),
ivec3(109,55,85),
ivec3(77,86,108),
ivec3(87,69,107),
ivec3(88,89,106),
ivec3(80,90,105),
ivec3(91,62,104),
ivec3(103,57,93),
ivec3(102,51,94),
ivec3(95,66,101),
ivec3(96,97,100),
ivec3(73,98,99),
ivec3(99,58,96),
ivec3(82,96,54),
ivec3(40,99,82),
ivec3(100,51,79),
ivec3(70,79,42),
ivec3(54,100,70),
ivec3(101,41,67),
ivec3(97,67,51),
ivec3(58,101,97),
ivec3(92,94,57),
ivec3(53,102,92),
ivec3(81,79,102),
ivec3(63,93,47),
ivec3(38,103,63),
ivec3(69,92,103),
ivec3(104,36,75),
ivec3(93,75,47),
ivec3(93,91,104),
ivec3(105,56,88),
ivec3(64,88,48),
ivec3(39,105,64),
ivec3(106,43,59),
ivec3(76,59,34),
ivec3(48,106,76),
ivec3(107,38,71),
ivec3(89,71,43),
ivec3(56,107,89),
ivec3(84,86,55),
ivec3(60,84,44),
ivec3(35,108,60),
ivec3(80,85,52),
ivec3(39,109,80),
ivec3(72,84,109),
ivec3(68,70,42),
ivec3(52,110,68),
ivec3(85,83,110),
ivec3(83,82,54),
ivec3(55,111,83),
ivec3(86,65,111),
ivec3(112,53,87),
ivec3(90,87,56),
ivec3(52,112,90),
ivec3(91,74,46),
ivec3(57,113,91),
ivec3(94,67,113),
ivec3(114,50,95),
ivec3(98,95,58),
ivec3(45,114,98),
ivec3(116,117,115),
ivec3(61,37,78),
ivec3(113,67,41),
ivec3(68,42,81),
ivec3(111,65,40),
ivec3(110,83,54),
ivec3(109,84,55),
ivec3(77,49,86),
ivec3(87,53,69),
ivec3(88,56,89),
ivec3(80,52,90),
ivec3(91,46,62),
ivec3(103,92,57),
ivec3(102,79,51),
ivec3(95,50,66),
ivec3(96,58,97),
ivec3(73,45,98),
ivec3(99,98,58),
ivec3(82,99,96),
ivec3(40,73,99),
ivec3(100,97,51),
ivec3(70,100,79),
ivec3(54,96,100),
ivec3(101,66,41),
ivec3(97,101,67),
ivec3(58,95,101),
ivec3(92,102,94),
ivec3(53,81,102),
ivec3(81,42,79),
ivec3(63,103,93),
ivec3(38,69,103),
ivec3(69,53,92),
ivec3(104,62,36),
ivec3(93,104,75),
ivec3(93,57,91),
ivec3(105,90,56),
ivec3(64,105,88),
ivec3(39,80,105),
ivec3(106,89,43),
ivec3(76,106,59),
ivec3(48,88,106),
ivec3(107,69,38),
ivec3(89,107,71),
ivec3(56,87,107),
ivec3(84,108,86),
ivec3(60,108,84),
ivec3(35,77,108),
ivec3(80,109,85),
ivec3(39,72,109),
ivec3(72,44,84),
ivec3(68,110,70),
ivec3(52,85,110),
ivec3(85,55,83),
ivec3(83,111,82),
ivec3(55,86,111),
ivec3(86,49,65),
ivec3(112,81,53),
ivec3(90,112,87),
ivec3(52,68,112),
ivec3(91,113,74),
ivec3(57,94,113),
ivec3(94,51,67),
ivec3(114,78,50),
ivec3(98,114,95),
ivec3(45,61,114),
ivec3(116,118,117), // pit end 163
ivec3(120,138,137),
ivec3(123,146,145),
ivec3(126,150,149),
ivec3(127,142,141),
ivec3(129,139,140),
ivec3(132,143,144),
ivec3(133,147,148),
ivec3(136,151,152),
ivec3(137,130,129),
ivec3(140,128,127),
ivec3(141,131,132),
ivec3(144,124,123),
ivec3(145,134,133),
ivec3(148,125,126),
ivec3(149,135,136),
ivec3(152,121,119),
ivec3(120,122,138),
ivec3(123,124,146),
ivec3(126,125,150),
ivec3(127,128,142),
ivec3(129,130,139),
ivec3(132,131,143),
ivec3(133,134,147),
ivec3(136,135,151),
ivec3(137,138,130),
ivec3(140,139,128),
ivec3(141,142,131),
ivec3(144,143,124),
ivec3(145,146,134),
ivec3(148,147,125),
ivec3(149,150,135),
ivec3(152,151,121), // ramp end 195
ivec3(154,186,185), // elevation start 196
ivec3(157,178,177),
ivec3(160,172,171),
ivec3(161,182,181),
ivec3(163,183,184),
ivec3(166,179,180),
ivec3(167,175,176),
ivec3(170,173,174),
ivec3(171,169,170),
ivec3(174,155,153),
ivec3(176,159,160),
ivec3(177,168,167),
ivec3(180,158,157),
ivec3(181,165,166),
ivec3(184,162,161),
ivec3(185,164,163),
ivec3(154,156,186),
ivec3(157,158,178),
ivec3(160,159,172),
ivec3(161,162,182),
ivec3(163,164,183),
ivec3(166,165,179),
ivec3(167,168,175),
ivec3(170,169,173),
ivec3(171,172,169),
ivec3(174,173,155),
ivec3(176,175,159),
ivec3(177,178,168),
ivec3(180,179,158),
ivec3(181,182,165),
ivec3(184,183,162),
ivec3(185,186,164), // elevation end 227
ivec3(188,189,187),
ivec3(190,193,189),
ivec3(194,191,193),
ivec3(192,187,191),
ivec3(193,187,189),
ivec3(190,192,194),
ivec3(188,190,189),
ivec3(190,194,193),
ivec3(194,192,191),
ivec3(192,188,187),
ivec3(193,191,187),
ivec3(190,188,192), // wall end 240
ivec3(198,206,196),
ivec3(195,197,203),
ivec3(208,209,207),
ivec3(210,211,209),
ivec3(212,213,211),
ivec3(214,215,213),
ivec3(216,217,215),
ivec3(218,219,217),
ivec3(220,221,219),
ivec3(222,207,221),
ivec3(213,217,221),
ivec3(196,199,200),
ivec3(200,198,196),
ivec3(206,198,205),
ivec3(198,195,205),
ivec3(197,200,201),
ivec3(200,199,201),
ivec3(204,205,195),
ivec3(197,201,202),
ivec3(203,204,195),
ivec3(197,202,203),
ivec3(208,210,209),
ivec3(210,212,211),
ivec3(212,214,213),
ivec3(214,216,215),
ivec3(216,218,217),
ivec3(218,220,219),
ivec3(220,222,221),
ivec3(222,208,207),
ivec3(221,207,209),
ivec3(209,211,213),
ivec3(213,215,217),
ivec3(217,219,221),
ivec3(221,209,213) // 274
);


float fastSin(float x) {
    return x * (1.27323954 - 0.405284735 * abs(x));
} 

float square(const float x) { return x * x ; }
float pow32(const float x) { return square(square(square(square(square(x))))); }

